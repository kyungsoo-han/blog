# Kafka 설치 경로 확인

### ✅ Kafka 설치 경로 확인

### macOS (Homebrew)

```
brew list kafka
```

Kafka 설치 위치 예시:

```
/opt/homebrew/Cellar/kafka/4.0.0
```

### Ubuntu

직접 압축 해제한 경우:

```
/opt/kafka
```

설치된 경우:

```
which kafka-server-start.sh
```

또는 `find / -name kafka-server-start.sh` 로 검색

---

### ✅ Kafka 설정 파일 위치

### macOS (Homebrew)

```
/opt/homebrew/etc/kafka/server.properties
```

### Ubuntu (수동 설치)

```
/opt/kafka/config/kraft/server.properties
```

또는

```
/opt/kafka/config/server.properties
```

---

### ✅ Kafka 포트 변경 방법

설정 파일(`server.properties`)에서 아래 항목 수정:

```
listeners=PLAINTEXT://:31010
advertised.listeners=PLAINTEXT://localhost:31010
```

KRaft 모드의 경우 컨트롤러 포트도 필요:

```
listeners=PLAINTEXT://:31010,CONTROLLER://:32010
```

---

### ✅ Kafka 시작/중지/확인 방법

### systemd 사용 시 (Ubuntu)

```
sudo systemctl start kafka
sudo systemctl stop kafka
sudo systemctl restart kafka
sudo systemctl status kafka
```

### systemd 미사용 (macOS)

```
brew services start kafka
brew services restart kafka
```

또는 직접 실행:

```
/opt/homebrew/bin/kafka-server-start /opt/homebrew/etc/kafka/server.properties
```

---

### ✅ 포트 확인 방법

```
lsof -i :31010
netstat -tulnp | grep 31010
```

---

### ✅ Kafka 관련 에러 해결

1. **Address already in use**
    - 포트 중복 사용 중. 기존 프로세스를 종료하거나 포트 변경 필요
2. **No `meta.properties` found**
    - 아래 명령어로 format 필요:
    
    ```
    /opt/kafka/bin/kafka-storage.sh random-uuid
    /opt/kafka/bin/kafka-storage.sh format --config /opt/kafka/config/kraft/server.properties --cluster-id <위에서 생성한 UUID>
    ```
    
3. **Connection to broker failed**
    - 포트가 열리지 않았거나 listeners 설정 불일치 → 포트 확인, 설정 재검토
4. **spring-boot에서 연결 오류**
    - `application.yml`의 `spring.kafka.bootstrap-servers` 값이 `advertised.listeners`와 일치해야 함

```
spring:
  kafka:
    bootstrap-servers: localhost:31010
```

---

### ✅ 권한 문제 해결

```
sudo chown -R hanks:hanks /opt/kafka/logs
```

Kafka 로그나 GC 로그 파일에 접근 불가할 때 권한 수정 필요

---

### ✅ 로그 확인

```
cat /opt/kafka/logs/server.log | tail -n 100
```

에러 추적 시 필수